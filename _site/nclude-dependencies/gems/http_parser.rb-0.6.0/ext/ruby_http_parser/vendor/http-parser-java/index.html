<!doctype>
<html lang="en">
  <head>
    <!--     Custom Styles     -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="In the distant future, during one of many nameless interstellar conflicts, a technology was perfected that could replace a persons morality, ethics, and empathy - named the prosthetic soul.">
    <meta name="author" content="prokhorVLG">
    <meta name="revisit-after" content="5 days">

    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <title>Unturned Stones</title>

    <!--     jQuery     -->
    <!--     The jQuery library.     -->
    <script src="/assets/js/jQuery/jquery-3.3.1.min.js"></script>
    <link rel="stylesheet" href="/assets/css/jQuery/jquery-ui.min.css">
    <link rel="stylesheet" href="/assets/css/jQuery/jquery-ui.theme.min.css">
    <script src="/assets/js/jQuery/jquery-ui.min.js"></script>

    <!--     jQuery: Shuffle Letters     -->
    <!--    The plugin that shuffles letters on certain text elements.     -->
    <script src="/assets/js/jQuery-plugins/jquery.shuffleLetters.js"></script>

    <!--     Animate on Scroll library     -->
    <!--     The library that animates elements when you scroll to/away from them.     -->
    <link href="https://cdn.rawgit.com/michalsnik/aos/2.1.1/dist/aos.css" rel="stylesheet">
    <script src="https://cdn.rawgit.com/michalsnik/aos/2.1.1/dist/aos.js"></script>
    

    <!--     Bootstrap Core     -->
    <!--     For setting up page layouts.     -->
    <link href="/assets/css/bootstrap/bootstrap.min.css" rel="stylesheet">
    <script src="/assets/js/bootstrap/bootstrap.min.js"></script>

    <!--     Web Fonts     -->
    <!--     Adds the site fonts.     -->
    <link href="https://fonts.googleapis.com/css?family=Cabin" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <!--     Custom Styles     -->
    <!--     Adds my site styles.     -->
    <link href="/assets/css/main-style.css" rel="stylesheet">

    <!-- <link href="/assets/css/pushmenu/icons.css" rel="stylesheet"> -->
    <link href="/assets/css/pushmenu/component.css" rel="stylesheet">

    <!--     Normalize     -->
    <!--     Adds cross-browser consistency and fixes some bugs.     -->
    <link href="/assets/css/normalize/normalize.css" rel="stylesheet">

    <!--     Custom Scripts     -->
    <script src="/assets/js/site/site-parallax.js"></script>
    <script src="/assets/js/site/site-shufflequote.js"></script>
    <script src="/assets/js/pushmenu/modernizr.custom.js"></script>
    
  </head>
  <body>

    <div class="mpc-side color-bg-1">
      <div class="hamburger hamburger--emphatic" id="trigger">
            <div class="hamburger-box">
              <div class="hamburger-inner"></div>
            </div>
          </div>
    </div>
    <div class="siteContainer color-bg-2-l color-primary-l mpc-container">
      <div class="navContainer mp-pusher" id="mp-pusher">

        <!--     Includes the navigation menu on the side of the site.     -->
        <nav id="mp-menu" class="mp-menu">
  <div class="mp-level">
    <h2 class="icon icon-world">Unturned Stones</h2>
    <hr class="full">
    <p>Modern cyberpunk.</p>
    <ul>
      <li class="icon icon-arrow-left">
        <a class="icon icon-display" href="#">Devices</a>
        <div class="mp-level">
          <h2 class="icon icon-display">Devices</h2>
          <a class="mp-back" href="#">back</a>
          <ul>
            <li class="icon icon-arrow-left">
              <a class="icon icon-phone" href="#">Mobile Phones</a>
              <div class="mp-level">
                <h2>Mobile Phones</h2>
                <a class="mp-back" href="#">back</a>
                <ul>
                  <li><a href="#">Super Smart Phone</a></li>
                  <li><a href="#">Thin Magic Mobile</a></li>
                  <li><a href="#">Performance Crusher</a></li>
                  <li><a href="#">Futuristic Experience</a></li>
                </ul>
              </div>
            </li>
            <li class="icon icon-arrow-left">
              <a class="icon icon-tv" href="#">Televisions</a>
              <div class="mp-level">
                <h2>Televisions</h2>
                <a class="mp-back" href="#">back</a>
                <ul>
                  <li><a href="#">Flat Superscreen</a></li>
                  <li><a href="#">Gigantic LED</a></li>
                  <li><a href="#">Power Eater</a></li>
                  <li><a href="#">3D Experience</a></li>
                  <li><a href="#">Classic Comfort</a></li>
                </ul>
              </div>
            </li>
            <li class="icon icon-arrow-left">
              <a class="icon icon-camera" href="#">Cameras</a>
              <div class="mp-level">
                <h2>Cameras</h2>
                <a class="mp-back" href="#">back</a>
                <ul>
                  <li><a href="#">Smart Shot</a></li>
                  <li><a href="#">Power Shooter</a></li>
                  <li><a href="#">Easy Photo Maker</a></li>
                  <li><a href="#">Super Pixel</a></li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </li>
      <li class="icon icon-arrow-left">
        <a class="icon icon-news" href="#">Magazines</a>
        <div class="mp-level">
          <h2 class="icon icon-news">Magazines</h2>
          <a class="mp-back" href="#">back</a>
          <ul>
            <li><a href="#">National Geographic</a></li>
            <li><a href="#">Scientific American</a></li>
            <li><a href="#">The Spectator</a></li>
            <li><a href="#">The Rambler</a></li>
            <li><a href="#">Physics World</a></li>
            <li><a href="#">The New Scientist</a></li>
          </ul>
        </div>
      </li>
      <li class="icon icon-arrow-left">
        <a class="icon icon-shop" href="#">Store</a>
        <div class="mp-level">
          <h2 class="icon icon-shop">Store</h2>
          <a class="mp-back" href="#">back</a>
          <ul>
            <li class="icon icon-arrow-left">
              <a class="icon icon-t-shirt" href="#">Clothes</a>
              <div class="mp-level">
                <h2 class="icon icon-t-shirt">Clothes</h2>
                <a class="mp-back" href="#">back</a>
                <ul>
                  <li class="icon icon-arrow-left">
                    <a class="icon icon-female" href="#">Women's Clothing</a>
                    <div class="mp-level">
                      <h2 class="icon icon-female">Women's Clothing</h2>
                      <a class="mp-back" href="#">back</a>
                      <ul>
                        <li><a href="#">Tops</a></li>
                        <li><a href="#">Dresses</a></li>
                        <li><a href="#">Trousers</a></li>
                        <li><a href="#">Shoes</a></li>
                        <li><a href="#">Sale</a></li>
                      </ul>
                    </div>
                  </li>
                  <li class="icon icon-arrow-left">
                    <a class="icon icon-male" href="#">Men's Clothing</a>
                    <div class="mp-level">
                      <h2 class="icon icon-male">Men's Clothing</h2>
                      <a class="mp-back" href="#">back</a>
                      <ul>
                        <li><a href="#">Shirts</a></li>
                        <li><a href="#">Trousers</a></li>
                        <li><a href="#">Shoes</a></li>
                        <li><a href="#">Sale</a></li>
                      </ul>
                    </div>
                  </li>
                </ul>
              </div>
            </li>
            <li>
              <a class="icon icon-diamond" href="#">Jewelry</a>
            </li>
            <li>
              <a class="icon icon-music" href="#">Music</a>
            </li>
            <li>
              <a class="icon icon-food" href="#">Grocery</a>
            </li>
          </ul>
        </div>
      </li>
      <li><a class="icon icon-photo" href="#">Collections</a></li>
      <li><a class="icon icon-wallet" href="#">Credits</a></li>
    </ul>
      
  </div>
</nav>

        <!--     Contains the site, which is pushed when the nav is opened.     -->
        <div class="contentContainer mpc-scroller">

          <!--     Includes the header at the top of the site.     -->
          This is the header.

          <!--     Contains whatever content is templated into the page.     -->
          <h1 id="http-parser">HTTP Parser</h1>

<p>This is a parser for HTTP written in Java, based quite heavily on
the Ryan Dahl’s C Version: <code class="highlighter-rouge">http-parser</code> available here:</p>

<p>http://github.com/ry/http-parser</p>

<p>It parses both requests and responses. The parser is designed to be used
in performance HTTP applications.</p>

<p>Features:</p>

<ul>
  <li>No dependencies (probably won’t be able to keep it up)</li>
  <li>Handles persistent streams (keep-alive).</li>
  <li>Decodes chunked encoding.</li>
  <li>Upgrade support</li>
</ul>

<p>The parser extracts the following information from HTTP messages:</p>

<ul>
  <li>Header fields and values</li>
  <li>Content-Length</li>
  <li>Request method</li>
  <li>Response status code</li>
  <li>Transfer-Encoding</li>
  <li>HTTP version</li>
  <li>Request URL</li>
  <li>Message body</li>
</ul>

<h2 id="building">Building</h2>

<p>use <code class="highlighter-rouge">ant compile|test|jar</code></p>

<h2 id="usage">Usage</h2>

<p>TODO: in the present form, usage of the Java version of the parser
  shouldn’t be too difficult to figure out for someone familiar with the
  C version.</p>

<p>More documentation will follow shortly, in case you’re looking for an
  easy to use http library, this lib is probably not what you are
  looking for anyway …</p>

<p>All text after this paragraph (and most of the text above it) are from
  the original C version of the README and are currently only here for
  reference. In case you encounter any difficulties, find bugs, need
  help or have suggestions, feel free to contact me at
  (tim.becker@kuriositaet.de).</p>

<p>One <code class="highlighter-rouge">http_parser</code> object is used per TCP connection. Initialize the struct
using <code class="highlighter-rouge">http_parser_init()</code> and set the callbacks. That might look something
like this for a request parser:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http_parser_settings settings;
settings.on_path = my_path_callback;
settings.on_header_field = my_header_field_callback;
/* ... */

http_parser *parser = malloc(sizeof(http_parser));
http_parser_init(parser, HTTP_REQUEST);
parser-&gt;data = my_socket;
</code></pre></div></div>

<p>When data is received on the socket execute the parser and check for errors.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>size_t len = 80*1024, nparsed;
char buf[len];
ssize_t recved;

recved = recv(fd, buf, len, 0);

if (recved &lt; 0) {
  /* Handle error. */
}

/* Start up / continue the parser.
 * Note we pass recved==0 to signal that EOF has been recieved.
 */
nparsed = http_parser_execute(parser, &amp;settings, buf, recved);

if (parser-&gt;upgrade) {
  /* handle new protocol */
} else if (nparsed != recved) {
  /* Handle error. Usually just close the connection. */
}
</code></pre></div></div>

<p>HTTP needs to know where the end of the stream is. For example, sometimes
servers send responses without Content-Length and expect the client to
consume input (for the body) until EOF. To tell http_parser about EOF, give
<code class="highlighter-rouge">0</code> as the forth parameter to <code class="highlighter-rouge">http_parser_execute()</code>. Callbacks and errors
can still be encountered during an EOF, so one must still be prepared
to receive them.</p>

<p>Scalar valued message information such as <code class="highlighter-rouge">status_code</code>, <code class="highlighter-rouge">method</code>, and the
HTTP version are stored in the parser structure. This data is only
temporally stored in <code class="highlighter-rouge">http_parser</code> and gets reset on each new message. If
this information is needed later, copy it out of the structure during the
<code class="highlighter-rouge">headers_complete</code> callback.</p>

<p>The parser decodes the transfer-encoding for both requests and responses
transparently. That is, a chunked encoding is decoded before being sent to
the on_body callback.</p>

<h2 id="the-special-problem-of-upgrade">The Special Problem of Upgrade</h2>

<p>HTTP supports upgrading the connection to a different protocol. An
increasingly common example of this is the Web Socket protocol which sends
a request like</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    GET /demo HTTP/1.1
    Upgrade: WebSocket
    Connection: Upgrade
    Host: example.com
    Origin: http://example.com
    WebSocket-Protocol: sample
</code></pre></div></div>

<p>followed by non-HTTP data.</p>

<p>(See http://tools.ietf.org/html/draft-hixie-thewebsocketprotocol-75 for more
information the Web Socket protocol.)</p>

<p>To support this, the parser will treat this as a normal HTTP message without a
body. Issuing both on_headers_complete and on_message_complete callbacks. However
http_parser_execute() will stop parsing at the end of the headers and return.</p>

<p>The user is expected to check if <code class="highlighter-rouge">parser-&gt;upgrade</code> has been set to 1 after
<code class="highlighter-rouge">http_parser_execute()</code> returns. Non-HTTP data begins at the buffer supplied
offset by the return value of <code class="highlighter-rouge">http_parser_execute()</code>.</p>

<h2 id="callbacks">Callbacks</h2>

<p>During the <code class="highlighter-rouge">http_parser_execute()</code> call, the callbacks set in
<code class="highlighter-rouge">http_parser_settings</code> will be executed. The parser maintains state and
never looks behind, so buffering the data is not necessary. If you need to
save certain data for later usage, you can do that from the callbacks.</p>

<p>There are two types of callbacks:</p>

<ul>
  <li>notification <code class="highlighter-rouge">typedef int (*http_cb) (http_parser*);</code>
  Callbacks: on_message_begin, on_headers_complete, on_message_complete.</li>
  <li>data <code class="highlighter-rouge">typedef int (*http_data_cb) (http_parser*, const char *at, size_t length);</code>
  Callbacks: (requests only) on_uri,
             (common) on_header_field, on_header_value, on_body;</li>
</ul>

<p>Callbacks must return 0 on success. Returning a non-zero value indicates
error to the parser, making it exit immediately.</p>

<p>In case you parse HTTP message in chunks (i.e. <code class="highlighter-rouge">read()</code> request line
from socket, parse, read half headers, parse, etc) your data callbacks
may be called more than once. Http-parser guarantees that data pointer is only
valid for the lifetime of callback. You can also <code class="highlighter-rouge">read()</code> into a heap allocated
buffer to avoid copying memory around if this fits your application.</p>

<p>Reading headers may be a tricky task if you read/parse headers partially.
Basically, you need to remember whether last header callback was field or value
and apply following logic:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(on_header_field and on_header_value shortened to on_h_*)
 ------------------------ ------------ --------------------------------------------
| State (prev. callback) | Callback   | Description/action                         |
 ------------------------ ------------ --------------------------------------------
| nothing (first call)   | on_h_field | Allocate new buffer and copy callback data |
|                        |            | into it                                    |
 ------------------------ ------------ --------------------------------------------
| value                  | on_h_field | New header started.                        |
|                        |            | Copy current name,value buffers to headers |
|                        |            | list and allocate new buffer for new name  |
 ------------------------ ------------ --------------------------------------------
| field                  | on_h_field | Previous name continues. Reallocate name   |
|                        |            | buffer and append callback data to it      |
 ------------------------ ------------ --------------------------------------------
| field                  | on_h_value | Value for current header started. Allocate |
|                        |            | new buffer and copy callback data to it    |
 ------------------------ ------------ --------------------------------------------
| value                  | on_h_value | Value continues. Reallocate value buffer   |
|                        |            | and append callback data to it             |
 ------------------------ ------------ --------------------------------------------
</code></pre></div></div>


          <!--     Includes the footer at the end of the site.     -->
          Footer.

        </div>
      </div>
    </div>
    <!--     Pushmenu     -->
    <script src="/assets/js/pushmenu/classie.js"></script>
    <script src="/assets/js/pushmenu/mlpushmenu.js"></script>
    <script>
      new mlPushMenu( document.getElementById( 'mp-menu' ), document.getElementById( 'trigger' ) );
    </script>

  </body>
</html>